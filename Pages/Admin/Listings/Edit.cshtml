@page
@model LocalBakery.Pages.Admin.Listings.EditModel
@{
  ViewData["Title"] = "Edit Listing";
}

<section style="display:grid; gap:20px;">
  <header class="page-header">
    <h1 style="margin:0;">Edit Listing</h1>
    <p class="muted" style="margin:0;">Update details and availability.</p>
  </header>

  <form method="post" asp-page="/Admin/Listings/Edit" asp-route-id="@Model.Item.Id" class="form-card" enctype="multipart/form-data">
    <div asp-validation-summary="All" class="muted" style="font-size:13px;"></div>
    <input type="hidden" asp-for="Item.Id" />
    <div class="form-grid">
      <label style="display:grid; gap:6px;">
        <span class="muted" style="font-size:13px;">Name</span>
        <input asp-for="Item.Name" />
        <span asp-validation-for="Item.Name" class="muted" style="font-size:12px;"></span>
      </label>
      <label style="display:grid; gap:6px;">
        <span class="muted" style="font-size:13px;">Category</span>
        <input asp-for="Item.Category" />
        <span asp-validation-for="Item.Category" class="muted" style="font-size:12px;"></span>
      </label>
      <label style="display:grid; gap:6px;">
        <span class="muted" style="font-size:13px;">Price</span>
        <input asp-for="Item.Price" type="number" step="0.01" min="0" />
        <span asp-validation-for="Item.Price" class="muted" style="font-size:12px;"></span>
      </label>
    </div>

    <label style="display:grid; gap:6px;">
      <span class="muted" style="font-size:13px;">Description</span>
      <textarea asp-for="Item.Description" rows="4"></textarea>
      <span asp-validation-for="Item.Description" class="muted" style="font-size:12px;"></span>
    </label>

    <div class="form-grid">
      <label style="display:grid; gap:6px;">
        <span class="muted" style="font-size:13px;">Tags (comma-separated)</span>
        <input asp-for="Item.TagsCsv" placeholder="Gluten-free, Vegan, Bestseller" />
        <span asp-validation-for="Item.TagsCsv" class="muted" style="font-size:12px;"></span>
      </label>
      <label style="display:grid; gap:6px;">
        <span class="muted" style="font-size:13px;">Daily stock (0 = unlimited)</span>
        <input asp-for="Item.DailyStock" type="number" min="0" step="1" />
        <span asp-validation-for="Item.DailyStock" class="muted" style="font-size:12px;"></span>
      </label>
      <label style="display:grid; gap:6px;">
        <span class="muted" style="font-size:13px;">Allergens</span>
        <input asp-for="Item.Allergens" />
        <span asp-validation-for="Item.Allergens" class="muted" style="font-size:12px;"></span>
      </label>
      <label style="display:grid; gap:6px;">
        <span class="muted" style="font-size:13px;">Replace Image</span>
        <input asp-for="ImageFile" type="file" accept=".jpg,.jpeg,.png,.webp,.gif" />
        <span asp-validation-for="ImageFile" class="muted" style="font-size:12px;"></span>
      </label>
      <label style="display:flex; gap:8px; align-items:center;">
        <input asp-for="Item.IsAvailable" type="checkbox" />
        <span class="muted" style="font-size:13px;">Available</span>
      </label>
    </div>

    @{
      var currentImage = string.IsNullOrWhiteSpace(Model.Item.ImagePath)
        ? "/images/placeholder.svg"
        : Model.Item.ImagePath;
    }
    <div style="display:flex; gap:12px; align-items:center;">
      <img src="@currentImage" alt="" style="width:72px; height:72px; border-radius:12px; object-fit:cover;" />
      <span class="muted" style="font-size:13px;">Current image</span>
    </div>

    <div class="inline-actions">
      <button class="primary" type="submit">Save Changes</button>
      <a class="button" href="/Admin/Listings">Cancel</a>
    </div>
  </form>
</section>

@section Scripts {
  <partial name="_ValidationScriptsPartial" />
}
